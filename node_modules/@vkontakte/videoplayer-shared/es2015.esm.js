/**
 * @vkontakte/videoplayer-shared v1.0.17
 * Thu, 01 Sep 2022 13:39:40 GMT
 * https://st.mycdn.me/static/vkontakte-videoplayer/1-0-17/doc/
 */
class t{constructor(){this.subscriptions=[]}unsubscribe(){const t=this.subscriptions;this.subscriptions=[],t.forEach((t=>'function'==typeof t?t():t.unsubscribe()))}add(t){return this.subscriptions.push(t),this}}const e=t=>{throw new Error(`${t} is value of unexpected type`)},r=t=>{},n=()=>{};class s{constructor(t){t&&(this._subscribe=t)}subscribe(r,s){var i;let o;o=s?'function'==typeof s?{next:s,error:n}:{next:t=>s.next(t),error:t=>{var e;return null===(e=s.error)||void 0===e?void 0:e.call(s,t)}}:{next:n,error:n};const c='function'==typeof r?{next:t=>{try{r(t)}catch(t){o.next(t)}},error:t=>o.next(t)}:{next:t=>r.next(t),error:t=>r.error?r.error(t):o.next(t)};let a;try{a=this._subscribe(c)}catch(t){null===(i=c.error)||void 0===i||i.call(c,t)}return(new t).add((()=>{switch(c.next=n,c.error=n,typeof a){case'function':return void a();case'object':return void a.unsubscribe();case'undefined':return;default:return e(a)}}))}pipe(...t){return t.reduce(((t,e)=>e(t)),this)}_subscribe(t){}}class i extends s{constructor(){super(),this.keyCounter=0,this.subscribers=new Map}next(t){this.subscribers.forEach((e=>e.next(t)))}error(t){this.subscribers.forEach((e=>{var r;return null===(r=e.error)||void 0===r?void 0:r.call(e,t)}))}_subscribe(e){const r=this.keyCounter++;return this.subscribers.set(r,e),(new t).add((()=>this.subscribers.delete(r)))}}class o{constructor(){this.log$=new i,this.logs=[],this.log=t=>{const e=Object.assign(Object.assign({},t),{timestamp:Date.now()});this.logs.push(e),this.log$.next(e)},this.getAllLogs=()=>this.logs}createCustomLog(t){return(...e)=>{let r;try{r=t(...e)}catch(t){r={message:'error in `createCustomLog`',component:'Logger'}}this.log(r)}}createComponentLog(t){return this.createCustomLog((e=>Object.assign({component:t},e)))}}function c(t,e='Assertion "value is not nullable" failed'){if(null==t)throw new Error(e)}function a(t,e='Assertion "value is nullable" failed'){if(null!=t)throw new Error(e)}function u(t){return null!=t}function l(t){return null==t}const h=(t,e,r)=>new Promise(((n,s)=>{e.addEventListener('abort',(()=>{c(),u.remove()}));const i=()=>{c(),s()},o=()=>{c(),n()},c=()=>{a&&clearTimeout(a),u.removeEventListener('load',o),u.removeEventListener('error',i)};let a;r&&(a=window.setTimeout(i,r));const u=document.createElement('script');u.addEventListener('load',o),u.addEventListener('error',i),u.src=t,document.head.appendChild(u)}));var d;const b='function'==typeof(null===(d=window.performance)||void 0===d?void 0:d.now)?()=>window.performance.now():()=>Date.now();function w(t,e,r,n){return new(r||(r=Promise))((function(s,i){function o(t){try{a(n.next(t))}catch(t){i(t)}}function c(t){try{a(n.throw(t))}catch(t){i(t)}}function a(t){var e;t.done?s(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(o,c)}a((n=n.apply(t,e||[])).next())}))}const v=(t,e)=>(...r)=>w(void 0,void 0,void 0,(function*(){var n;const s=e(...r);let i,o=t.aborted;for(;!o&&!t.aborted;){const t=yield s.next(i);o=null!==(n=t.done)&&void 0!==n&&n,i=t.value}return i})),f=(t,{start:e=0,factor:r=2,max:n=1/0,min:s=e,random:i=0}={})=>{let o=e;return o*=Math.pow(r,t),o*=Math.random()*i*2-i+1,o=Math.round(o),o=Math.min(o,n),o=Math.max(o,s),o};class x extends i{constructor(t){super(),this.value=t}next(t){super.next(this.value=t)}error(t){super.error(this.value=t)}getValue(){return this.value}_subscribe(t){const e=super._subscribe(t);return t.next(this.value),e}}function m(e){return new s((r=>{const n={};let s=Object.keys(e).length;return Object.entries(e).reduce(((t,[e,i])=>t.add(i.subscribe((t=>e=>{t in n||s--,n[t]=e,0===s&&r.next(n)})(e)))),new t)}))}function p(...e){return new s((r=>e.reduce(((t,e)=>t.add(e.subscribe(r))),new t)))}var g=t=>new s((e=>{const r=window.setTimeout((()=>{try{e.next()}catch(t){if(!e.error)throw t;e.error(t)}}),t);return()=>window.clearTimeout(r)})),y=t=>new s((e=>{const r=window.setInterval((()=>e.next()),t);return()=>window.clearInterval(r)})),L=t=>new s((e=>{t.forEach((t=>e.next(t)))})),E=(t,e)=>new s((r=>{const n=t=>r.next(t);return t.addEventListener(e,n),()=>t.removeEventListener(e,n)}));const V={leading:!1,trailing:!0};function C(t,e=V){return r=>new s((n=>r.subscribe(new T(n,t,e))))}class T{constructor(t,e,r){this.destination=t,this.time=e,this.config=r}next(t){this.lastValue=t,u(this.timeout)?window.clearTimeout(this.timeout):this.config.leading&&this.destination.next(t),this.timeout=window.setTimeout((()=>{if(this.config.trailing)try{this.destination.next(this.lastValue)}catch(t){if(!this.destination.error)throw t;this.destination.error(t)}this.timeout=void 0}),this.time)}error(t){var e,r;null===(r=(e=this.destination).error)||void 0===r||r.call(e,t)}}const j={leading:!0,trailing:!1};function M(t,e=j){return r=>new s((n=>r.subscribe(new _(n,t,e))))}class _{constructor(t,e,r){this.destination=t,this.time=e,this.config=r}next(t){this.lastValue=t,l(this.timeout)&&(this.config.leading&&this.destination.next(t),this.timeout=window.setTimeout((()=>{this.config.trailing&&this.destination.next(this.lastValue),this.timeout=void 0}),this.time))}error(t){var e,r;null===(r=(e=this.destination).error)||void 0===r||r.call(e,t)}}function O(t){return e=>new s((r=>e.subscribe(new k(r,t))))}class k{constructor(t,e){this.destination=t,this.predicate=e}next(t){let e;try{e=this.predicate(t)}catch(t){throw this.error(t),t}e&&this.destination.next(t)}error(t){var e,r;null===(r=(e=this.destination).error)||void 0===r||r.call(e,t)}}function A(t=((t,e)=>t===e)){return e=>new s((r=>e.subscribe(new D(r,t))))}const $={};class D{constructor(t,e){this.destination=t,this.predicate=e,this.lastValue=$}next(t){let e;try{e=this.lastValue===$||!this.predicate(this.lastValue,t),this.lastValue=t}catch(t){throw this.error(t),t}e&&this.destination.next(t)}error(t){var e,r;null===(r=(e=this.destination).error)||void 0===r||r.call(e,t)}}function I(t){return e=>new s((r=>e.subscribe(new P(r,t))))}class P{constructor(t,e){this.destination=t,this.mapper=e}next(t){let e;try{e=this.mapper(t)}catch(t){throw this.error(t),t}this.destination.next(e)}error(t){var e,r;null===(r=(e=this.destination).error)||void 0===r||r.call(e,t)}}function q(t){return I((()=>t))}function z(){return t=>new s((e=>{let r=!1,n=!1;const s=t.subscribe((t=>{r||(r=!0,e.next(t)),n&&s.unsubscribe()}),(t=>{var i;r=!0,null===(i=e.error)||void 0===i||i.call(e,t),n&&s.unsubscribe()}));return n=!0,r&&s.unsubscribe(),s}))}function B(){return t=>new s((e=>t.subscribe(new F(e))))}class F{constructor(t){this.destination=t,this.hasLast=!1}next(t){const e=this.last;this.last=t,this.hasLast?this.destination.next([e,t]):this.hasLast=!0}error(t){var e,r;null===(r=(e=this.destination).error)||void 0===r||r.call(e,t)}}function G(t){return e=>new s((r=>e.subscribe(new H(r,t))))}class H{constructor(t,e){this.destination=t,this.effect=e}next(t){try{this.effect(t)}catch(t){throw this.error(t),t}this.destination.next(t)}error(t){var e,r;null===(r=(e=this.destination).error)||void 0===r||r.call(e,t)}}export{o as Logger,s as Observable,i as Subject,t as Subscription,x as ValueSubject,v as abortable,h as addScript,e as assertNever,c as assertNonNullable,a as assertNullable,r as checkNever,m as combine,C as debounce,O as filter,A as filterChanged,E as fromEvent,f as getExponentialDelay,y as interval,u as isNonNullable,l as isNullable,I as map,q as mapTo,p as merge,n as noop,b as now,L as observableFrom,z as once,B as pairwise,G as tap,M as throttle,g as timeout};
