{"ast":null,"code":"import _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\nimport _defineProperty from \"@babel/runtime/helpers/defineProperty\";\n\nvar CustomStorage = /*#__PURE__*/function () {\n  function CustomStorage() {\n    var _this = this;\n\n    _classCallCheck(this, CustomStorage);\n\n    _defineProperty(this, \"data\", {});\n\n    _defineProperty(this, \"getItem\", function (key) {\n      return _this.data.hasOwnProperty(key) ? _this.data[key] : null;\n    });\n\n    _defineProperty(this, \"keys\", function () {\n      return Object.keys(_this.data);\n    });\n  }\n\n  _createClass(CustomStorage, [{\n    key: \"setItem\",\n    value: function setItem(key, val) {\n      this.data[key] = String(val);\n    }\n  }, {\n    key: \"removeItem\",\n    value: function removeItem(id) {\n      delete this.data[id];\n    }\n  }, {\n    key: \"clear\",\n    value: function clear() {\n      this.data = {};\n    }\n  }, {\n    key: \"key\",\n    value: function key(index) {\n      return Object.keys(this.data)[index];\n    }\n  }, {\n    key: \"length\",\n    get: function get() {\n      return Object.keys(this.data).length;\n    }\n  }]);\n\n  return CustomStorage;\n}();\n\nvar dummyKey = 'vk-ls-dummy';\nvar dummyContent = 'test';\nvar ls;\n\nfunction getLocalStorage() {\n  if (ls) {\n    return ls;\n  }\n\n  try {\n    // Проверяем, нет ли в FF или Safari cross domain security restrictions\n    window.localStorage.setItem(dummyKey, dummyContent);\n\n    if (dummyContent !== window.localStorage.getItem(dummyKey)) {\n      throw new Error('localStorage is broken');\n    }\n\n    window.localStorage.removeItem(dummyKey);\n    ls = window.localStorage;\n  } catch (e) {\n    ls = new CustomStorage();\n  }\n\n  return ls;\n}\n/**\n * Обертка над localStorage для кода, который может использоваться на других сайтах\n * Firefox блокирует доступ к localStorage для скриптов с других доменов\n */\n\n\nexport var localStorage = {\n  setItem: function setItem(key, val) {\n    return getLocalStorage().setItem(key, val);\n  },\n  getItem: function getItem(key) {\n    return getLocalStorage().getItem(key);\n  },\n  removeItem: function removeItem(key) {\n    return getLocalStorage().removeItem(key);\n  },\n  clear: function clear() {\n    return getLocalStorage().clear();\n  },\n  length: function length() {\n    return getLocalStorage().length;\n  },\n  key: function key(index) {\n    return getLocalStorage().key(index);\n  },\n  keys: function keys() {\n    var storage = getLocalStorage();\n\n    if (storage instanceof CustomStorage) {\n      return storage.keys();\n    } else {\n      return Object.keys(storage);\n    }\n  },\n  getPrefixedKeys: function getPrefixedKeys(prefix) {\n    return localStorage.keys().filter(function (key) {\n      return key.startsWith(prefix);\n    });\n  }\n};\nvar sessionStorageCache;\n\nfunction getSessionStorage() {\n  if (sessionStorageCache) {\n    return sessionStorageCache;\n  }\n\n  try {\n    // Проверяем, нет ли в FF или Safari cross domain security restrictions\n    window.sessionStorage.setItem(dummyKey, dummyContent);\n\n    if (dummyContent !== window.sessionStorage.getItem(dummyKey)) {\n      throw new Error('sessionStorage is broken');\n    }\n\n    window.sessionStorage.removeItem(dummyKey);\n    sessionStorageCache = window.sessionStorage;\n  } catch (e) {\n    sessionStorageCache = new CustomStorage();\n  }\n\n  return sessionStorageCache;\n}\n\nexport var sessionStorage = {\n  setItem: function setItem(key, val) {\n    return getSessionStorage().setItem(key, val);\n  },\n  getItem: function getItem(key) {\n    return getSessionStorage().getItem(key);\n  },\n  removeItem: function removeItem(key) {\n    return getSessionStorage().removeItem(key);\n  },\n  clear: function clear() {\n    return getSessionStorage().clear();\n  },\n  length: function length() {\n    return getSessionStorage().length;\n  },\n  key: function key(index) {\n    return getSessionStorage().key(index);\n  },\n  keys: function keys() {\n    var storage = getSessionStorage();\n\n    if (storage instanceof CustomStorage) {\n      return storage.keys();\n    } else {\n      return Object.keys(storage);\n    }\n  },\n  getPrefixedKeys: function getPrefixedKeys(prefix) {\n    return sessionStorage.keys().filter(function (key) {\n      return key.startsWith(prefix);\n    });\n  }\n};","map":{"version":3,"mappings":"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","names":["CustomStorage","key","_this","data","hasOwnProperty","Object","keys","val","String","id","index","length","dummyKey","dummyContent","ls","getLocalStorage","window","localStorage","setItem","getItem","Error","removeItem","e","clear","storage","getPrefixedKeys","prefix","filter","startsWith","sessionStorageCache","getSessionStorage","sessionStorage"],"sources":["/Users/al.balandin/code/vkvideo-test/node_modules/@vkontakte/vkui/node_modules/@vkontakte/vkjs/src/storage.ts"],"sourcesContent":["import { Dictionary } from './types';\n\nclass CustomStorage {\n  private data: Dictionary<string> = {};\n\n  public setItem(key: string, val: string) {\n    this.data[key] = String(val);\n  };\n\n  public getItem = (key: string) => this.data.hasOwnProperty(key) ? this.data[key] : null;\n\n  public removeItem(id: string) {\n    delete this.data[id];\n  };\n\n  public clear() {\n    this.data = {};\n  }\n\n  public get length() {\n    return Object.keys(this.data).length;\n  };\n\n  public key(index: number): string | null {\n    return Object.keys(this.data)[index];\n  }\n\n  public keys = (): string[] => Object.keys(this.data);\n}\n\nconst dummyKey = 'vk-ls-dummy';\nconst dummyContent = 'test';\n\nlet ls: CustomStorage | Storage;\n\nfunction getLocalStorage() {\n  if (ls) {\n    return ls;\n  }\n  try {\n    // Проверяем, нет ли в FF или Safari cross domain security restrictions\n    window.localStorage.setItem(dummyKey, dummyContent);\n    if (dummyContent !== window.localStorage.getItem(dummyKey)) {\n      throw new Error('localStorage is broken');\n    }\n    window.localStorage.removeItem(dummyKey);\n    ls = window.localStorage;\n  } catch (e) {\n    ls = new CustomStorage();\n  }\n  return ls;\n}\n\n/**\n * Обертка над localStorage для кода, который может использоваться на других сайтах\n * Firefox блокирует доступ к localStorage для скриптов с других доменов\n */\nexport const localStorage = {\n  setItem: (key: string, val: string) => getLocalStorage().setItem(key, val),\n  getItem: (key: string) => getLocalStorage().getItem(key),\n  removeItem: (key: string) => getLocalStorage().removeItem(key),\n  clear: () => getLocalStorage().clear(),\n  length: () => getLocalStorage().length,\n  key: (index: number) => getLocalStorage().key(index),\n  keys(): string[] {\n    const storage = getLocalStorage();\n    if (storage instanceof CustomStorage) {\n      return storage.keys();\n    } else {\n      return Object.keys(storage);\n    }\n  },\n  getPrefixedKeys: (prefix: string): string[] => localStorage.keys().filter((key) => key.startsWith(prefix)),\n};\n\nlet sessionStorageCache: CustomStorage | Storage;\n\nfunction getSessionStorage() {\n  if (sessionStorageCache) {\n    return sessionStorageCache;\n  }\n  try {\n    // Проверяем, нет ли в FF или Safari cross domain security restrictions\n    window.sessionStorage.setItem(dummyKey, dummyContent);\n    if (dummyContent !== window.sessionStorage.getItem(dummyKey)) {\n      throw new Error('sessionStorage is broken');\n    }\n    window.sessionStorage.removeItem(dummyKey);\n    sessionStorageCache = window.sessionStorage;\n  } catch (e) {\n    sessionStorageCache = new CustomStorage();\n  }\n  return sessionStorageCache;\n}\n\nexport const sessionStorage = {\n  setItem: (key: string, val: string) => getSessionStorage().setItem(key, val),\n  getItem: (key: string) => getSessionStorage().getItem(key),\n  removeItem: (key: string) => getSessionStorage().removeItem(key),\n  clear: () => getSessionStorage().clear(),\n  length: () => getSessionStorage().length,\n  key: (index: number) => getSessionStorage().key(index),\n  keys(): string[] {\n    const storage = getSessionStorage();\n    if (storage instanceof CustomStorage) {\n      return storage.keys();\n    } else {\n      return Object.keys(storage);\n    }\n  },\n  getPrefixedKeys: (prefix: string): string[] => sessionStorage.keys().filter((key) => key.startsWith(prefix)),\n};\n"]},"metadata":{},"sourceType":"module"}