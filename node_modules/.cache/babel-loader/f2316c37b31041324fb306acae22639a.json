{"ast":null,"code":"import _extends from \"@babel/runtime/helpers/extends\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/objectWithoutProperties\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nvar _excluded = [\"getRootRef\", \"children\", \"onRemove\", \"removePlaceholder\", \"align\"];\nimport { createScopedElement } from \"../../lib/jsxRuntime\";\nimport * as React from \"react\";\nimport { classNames } from \"../../lib/classNames\";\nimport { getTitleFromChildren, noop } from \"../../lib/utils\";\nimport { useExternRef } from \"../../hooks/useExternRef\";\nimport { usePlatform } from \"../../hooks/usePlatform\";\nimport { getClassName } from \"../../helpers/getClassName\";\nimport { useAdaptivity } from \"../../hooks/useAdaptivity\";\nimport { useDOM } from \"../../lib/dom\";\nimport { ANDROID, IOS, VKCOM } from \"../../lib/platform\";\nimport { Icon24Cancel } from \"@vkontakte/icons\";\nimport IconButton from \"../IconButton/IconButton\";\nimport { useGlobalEventListener } from \"../../hooks/useGlobalEventListener\";\nimport Tappable from \"../Tappable/Tappable\";\n\nvar RemovableIos = function RemovableIos(_ref) {\n  var onRemove = _ref.onRemove,\n      removePlaceholder = _ref.removePlaceholder,\n      removePlaceholderString = _ref.removePlaceholderString,\n      children = _ref.children;\n\n  var _useDOM = useDOM(),\n      window = _useDOM.window;\n\n  var removeButtonRef = React.useRef(null);\n  var disabledRef = React.useRef(true);\n\n  var _React$useState = React.useState(0),\n      _React$useState2 = _slicedToArray(_React$useState, 2),\n      removeOffset = _React$useState2[0],\n      updateRemoveOffset = _React$useState2[1];\n\n  useGlobalEventListener(window, \"click\", function () {\n    if (removeOffset > 0) {\n      updateRemoveOffset(0);\n    }\n  }, {\n    capture: true\n  });\n\n  var onRemoveTransitionEnd = function onRemoveTransitionEnd() {\n    if (removeOffset > 0) {\n      var _removeButtonRef$curr;\n\n      removeButtonRef === null || removeButtonRef === void 0 ? void 0 : (_removeButtonRef$curr = removeButtonRef.current) === null || _removeButtonRef$curr === void 0 ? void 0 : _removeButtonRef$curr.focus();\n    } else {\n      disabledRef.current = true;\n    }\n  };\n\n  var onRemoveActivateClick = function onRemoveActivateClick(e) {\n    e.stopPropagation();\n\n    if (!removeButtonRef.current) {\n      return;\n    }\n\n    var offsetWidth = removeButtonRef.current.offsetWidth;\n    disabledRef.current = false;\n    updateRemoveOffset(offsetWidth);\n  };\n\n  return createScopedElement(\"div\", {\n    vkuiClass: \"Removable__content\",\n    style: {\n      transform: \"translateX(-\".concat(removeOffset !== null && removeOffset !== void 0 ? removeOffset : 0, \"px)\")\n    },\n    onTransitionEnd: onRemoveTransitionEnd\n  }, createScopedElement(IconButton, {\n    hasActive: false,\n    hasHover: false,\n    \"aria-label\": removePlaceholderString,\n    vkuiClass: \"Removable__action Removable__toggle\",\n    onClick: onRemoveActivateClick,\n    disabled: removeOffset > 0\n  }, createScopedElement(\"i\", {\n    vkuiClass: \"Removable__toggle-in\",\n    role: \"presentation\"\n  })), children, createScopedElement(\"span\", {\n    vkuiClass: \"Removable__offset\",\n    \"aria-hidden\": \"true\"\n  }), createScopedElement(Tappable, {\n    Component: \"button\",\n    hasActive: false,\n    hasHover: false,\n    disabled: disabledRef.current,\n    getRootRef: removeButtonRef,\n    vkuiClass: \"Removable__remove\",\n    onClick: onRemove\n  }, createScopedElement(\"span\", {\n    vkuiClass: \"Removable__remove-in\"\n  }, removePlaceholder)));\n};\n\nexport var Removable = function Removable(_ref2) {\n  var getRootRef = _ref2.getRootRef,\n      children = _ref2.children,\n      _ref2$onRemove = _ref2.onRemove,\n      onRemove = _ref2$onRemove === void 0 ? noop : _ref2$onRemove,\n      _ref2$removePlacehold = _ref2.removePlaceholder,\n      removePlaceholder = _ref2$removePlacehold === void 0 ? \"Удалить\" : _ref2$removePlacehold,\n      _ref2$align = _ref2.align,\n      align = _ref2$align === void 0 ? \"center\" : _ref2$align,\n      restProps = _objectWithoutProperties(_ref2, _excluded);\n\n  var platform = usePlatform();\n\n  var _useAdaptivity = useAdaptivity(),\n      sizeY = _useAdaptivity.sizeY;\n\n  var ref = useExternRef(getRootRef);\n\n  var onRemoveClick = function onRemoveClick(e) {\n    e.preventDefault();\n    onRemove(e);\n  };\n\n  var removePlaceholderString = getTitleFromChildren(removePlaceholder);\n  return createScopedElement(\"div\", _extends({}, restProps, {\n    ref: ref,\n    vkuiClass: classNames(getClassName(\"Removable\", platform), \"Removable--\".concat(align), \"Removable--sizeY-\".concat(sizeY))\n  }), (platform === ANDROID || platform === VKCOM) && createScopedElement(\"div\", {\n    vkuiClass: \"Removable__content\"\n  }, children, createScopedElement(IconButton, {\n    activeMode: \"opacity\",\n    hoverMode: \"opacity\",\n    vkuiClass: \"Removable__action\",\n    onClick: onRemoveClick,\n    \"aria-label\": removePlaceholderString\n  }, createScopedElement(Icon24Cancel, {\n    role: \"presentation\"\n  }))), platform === IOS && createScopedElement(RemovableIos, {\n    onRemove: onRemoveClick,\n    removePlaceholder: removePlaceholder,\n    removePlaceholderString: removePlaceholderString\n  }, children));\n};","map":{"version":3,"mappings":"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","names":["React","classNames","getTitleFromChildren","noop","useExternRef","usePlatform","getClassName","useAdaptivity","useDOM","ANDROID","IOS","VKCOM","Icon24Cancel","IconButton","useGlobalEventListener","Tappable","RemovableIos","onRemove","removePlaceholder","removePlaceholderString","children","window","removeButtonRef","useRef","disabledRef","useState","removeOffset","updateRemoveOffset","capture","onRemoveTransitionEnd","current","focus","onRemoveActivateClick","e","stopPropagation","offsetWidth","createScopedElement","vkuiClass","style","transform","onTransitionEnd","hasActive","hasHover","onClick","disabled","role","Component","getRootRef","Removable","align","restProps","platform","sizeY","ref","onRemoveClick","preventDefault","activeMode","hoverMode"],"sources":["/Users/al.balandin/code/vkvideo-test/node_modules/@vkontakte/vkui/src/components/Removable/Removable.tsx"],"sourcesContent":["import * as React from \"react\";\nimport { HasRootRef } from \"../../types\";\nimport { classNames } from \"../../lib/classNames\";\nimport { getTitleFromChildren, noop } from \"../../lib/utils\";\nimport { useExternRef } from \"../../hooks/useExternRef\";\nimport { usePlatform } from \"../../hooks/usePlatform\";\nimport { getClassName } from \"../../helpers/getClassName\";\nimport { useAdaptivity } from \"../../hooks/useAdaptivity\";\nimport { useDOM } from \"../../lib/dom\";\nimport { ANDROID, IOS, VKCOM } from \"../../lib/platform\";\nimport { Icon24Cancel } from \"@vkontakte/icons\";\nimport IconButton from \"../IconButton/IconButton\";\nimport { useGlobalEventListener } from \"../../hooks/useGlobalEventListener\";\nimport Tappable from \"../Tappable/Tappable\";\nimport \"./Removable.css\";\n\nexport interface RemovableProps {\n  /**\n   * iOS only. Текст в выезжающей кнопке для удаления ячейки.\n   */\n  removePlaceholder?: React.ReactNode;\n  /**\n   * Коллбэк срабатывает при клике на контрол удаления.\n   */\n  onRemove?: (e: React.MouseEvent, rootEl?: HTMLElement) => void;\n}\n\ninterface RemovableIosOwnProps extends RemovableProps {\n  removePlaceholderString?: string;\n}\n\nconst RemovableIos: React.FC<RemovableIosOwnProps> = ({\n  onRemove,\n  removePlaceholder,\n  removePlaceholderString,\n  children,\n}) => {\n  const { window } = useDOM();\n\n  const removeButtonRef = React.useRef<HTMLElement>(null);\n  const disabledRef = React.useRef(true);\n  const [removeOffset, updateRemoveOffset] = React.useState(0);\n\n  useGlobalEventListener(\n    window,\n    \"click\",\n    () => {\n      if (removeOffset > 0) {\n        updateRemoveOffset(0);\n      }\n    },\n    { capture: true }\n  );\n\n  const onRemoveTransitionEnd = () => {\n    if (removeOffset > 0) {\n      removeButtonRef?.current?.focus();\n    } else {\n      disabledRef.current = true;\n    }\n  };\n\n  const onRemoveActivateClick = (e: React.MouseEvent) => {\n    e.stopPropagation();\n    if (!removeButtonRef.current) {\n      return;\n    }\n    const { offsetWidth } = removeButtonRef.current;\n    disabledRef.current = false;\n    updateRemoveOffset(offsetWidth);\n  };\n\n  return (\n    <div\n      vkuiClass=\"Removable__content\"\n      style={{ transform: `translateX(-${removeOffset ?? 0}px)` }}\n      onTransitionEnd={onRemoveTransitionEnd}\n    >\n      <IconButton\n        hasActive={false}\n        hasHover={false}\n        aria-label={removePlaceholderString}\n        vkuiClass=\"Removable__action Removable__toggle\"\n        onClick={onRemoveActivateClick}\n        disabled={removeOffset > 0}\n      >\n        <i vkuiClass=\"Removable__toggle-in\" role=\"presentation\" />\n      </IconButton>\n      {children}\n\n      <span vkuiClass=\"Removable__offset\" aria-hidden=\"true\"></span>\n\n      <Tappable\n        Component=\"button\"\n        hasActive={false}\n        hasHover={false}\n        disabled={disabledRef.current}\n        getRootRef={removeButtonRef}\n        vkuiClass=\"Removable__remove\"\n        onClick={onRemove}\n      >\n        <span vkuiClass=\"Removable__remove-in\">{removePlaceholder}</span>\n      </Tappable>\n    </div>\n  );\n};\n\ninterface RemovableOwnProps\n  extends React.AllHTMLAttributes<HTMLElement>,\n    RemovableProps,\n    HasRootRef<HTMLDivElement> {\n  /**\n   * Расположение кнопки удаления.\n   */\n  align?: \"start\" | \"center\";\n}\n\nexport const Removable: React.FC<RemovableOwnProps> = ({\n  getRootRef,\n  children,\n  onRemove = noop,\n  removePlaceholder = \"Удалить\",\n  align = \"center\",\n  ...restProps\n}: RemovableOwnProps) => {\n  const platform = usePlatform();\n  const { sizeY } = useAdaptivity();\n\n  const ref = useExternRef(getRootRef);\n\n  const onRemoveClick = (e: React.MouseEvent) => {\n    e.preventDefault();\n    onRemove(e);\n  };\n\n  const removePlaceholderString: string =\n    getTitleFromChildren(removePlaceholder);\n\n  return (\n    <div\n      {...restProps}\n      ref={ref}\n      vkuiClass={classNames(\n        getClassName(\"Removable\", platform),\n        `Removable--${align}`,\n        `Removable--sizeY-${sizeY}`\n      )}\n    >\n      {(platform === ANDROID || platform === VKCOM) && (\n        <div vkuiClass=\"Removable__content\">\n          {children}\n\n          <IconButton\n            activeMode=\"opacity\"\n            hoverMode=\"opacity\"\n            vkuiClass=\"Removable__action\"\n            onClick={onRemoveClick}\n            aria-label={removePlaceholderString}\n          >\n            <Icon24Cancel role=\"presentation\" />\n          </IconButton>\n        </div>\n      )}\n\n      {platform === IOS && (\n        <RemovableIos\n          onRemove={onRemoveClick}\n          removePlaceholder={removePlaceholder}\n          removePlaceholderString={removePlaceholderString}\n        >\n          {children}\n        </RemovableIos>\n      )}\n    </div>\n  );\n};\n"]},"metadata":{},"sourceType":"module"}