{"ast":null,"code":"var _jsxFileName = \"/Users/al.balandin/code/vkvideo-test/src/Player/Player.jsx\",\n    _s = $RefreshSig$();\n\nimport React, { useEffect, useRef } from 'react';\nimport { registerPlayerWebComponent } from '@vkontakte/videoplayer';\nimport './Player.css';\n/** https://st.mycdn.me/static/vkontakte-videoplayer/latest/doc/index.html */\n\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst registerPlayer = () => {\n  if (!window.customElements.get('vk-video-player') && !window.customElements.get('google-cast-button')) {\n    registerPlayerWebComponent();\n  }\n};\n\nregisterPlayer();\nexport function Player(props) {\n  _s();\n\n  const {\n    src,\n    extraVideos\n  } = props;\n  const playerRef = useRef(null);\n  const wasInitedRef = useRef(false);\n  useEffect(() => {\n    const player = playerRef.current;\n\n    if (player && src && !wasInitedRef.current) {\n      wasInitedRef.current = true;\n      console.log(player);\n      console.log('INIT Player', src);\n\n      try {\n        player.initPlayer({\n          videos: [{\n            sources: {\n              MPEG: {\n                '1080p': src\n              }\n            },\n            duration: 1000,\n            thumbUrl: '',\n            title: 'title',\n            unitedVideoId: 0\n          }],\n          autoplay: true,\n          repeat: true,\n          isMobile: true,\n          callbacks: {\n            onEnded() {\n              console.log('ENDED');\n            },\n\n            onStarted() {\n              console.log('STARTED');\n            }\n\n          }\n        });\n      } catch (error) {\n        console.error('player.initPlayer error', error);\n      }\n    }\n  }, [playerRef, src, wasInitedRef]);\n  useEffect(() => {\n    const player = playerRef.current;\n\n    if (player && extraVideos !== null && extraVideos !== void 0 && extraVideos.length) {\n      player.updateNextVideos(extraVideos);\n    }\n  }, [extraVideos]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"VideoPlayer\",\n    children: /*#__PURE__*/_jsxDEV(\"vk-video-player\", {\n      ref: playerRef\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 69,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 68,\n    columnNumber: 5\n  }, this);\n}\n\n_s(Player, \"DnuYBFMoqYeXZBV0y5/+IJp2/hE=\");\n\n_c = Player;\n\nvar _c;\n\n$RefreshReg$(_c, \"Player\");","map":{"version":3,"names":["React","useEffect","useRef","registerPlayerWebComponent","registerPlayer","window","customElements","get","Player","props","src","extraVideos","playerRef","wasInitedRef","player","current","console","log","initPlayer","videos","sources","MPEG","duration","thumbUrl","title","unitedVideoId","autoplay","repeat","isMobile","callbacks","onEnded","onStarted","error","length","updateNextVideos"],"sources":["/Users/al.balandin/code/vkvideo-test/src/Player/Player.jsx"],"sourcesContent":["import React, { useEffect, useRef } from 'react'\nimport { registerPlayerWebComponent } from '@vkontakte/videoplayer'\nimport './Player.css'\n\n/** https://st.mycdn.me/static/vkontakte-videoplayer/latest/doc/index.html */\nconst registerPlayer = () => {\n  if (!window.customElements.get('vk-video-player') && !window.customElements.get('google-cast-button')) {\n    registerPlayerWebComponent()\n  }\n}\n\nregisterPlayer()\n\nexport function Player (props) {\n  const { src, extraVideos } = props\n\n  const playerRef = useRef(null)\n  const wasInitedRef = useRef(false)\n\n  useEffect(() => {\n    const player = playerRef.current\n    if (player && src && !wasInitedRef.current) {\n      wasInitedRef.current = true\n      console.log(player)\n      console.log('INIT Player', src)\n      try {\n        player.initPlayer({\n          videos: [\n            {\n              sources: {\n                MPEG: {\n                  '1080p': src\n                }\n              },\n              duration: 1000,\n              thumbUrl: '',\n              title: 'title',\n              unitedVideoId: 0\n            }\n          ],\n\n          autoplay: true,\n          repeat: true,\n          isMobile: true,\n          callbacks: {\n            onEnded () {\n              console.log('ENDED')\n            },\n            onStarted () {\n              console.log('STARTED')\n            }\n          }\n        })\n      } catch (error) {\n        console.error('player.initPlayer error', error)\n      }\n    }\n  }, [playerRef, src, wasInitedRef])\n\n  useEffect(() => {\n    const player = playerRef.current\n    if (player && extraVideos?.length) {\n      player.updateNextVideos(extraVideos)\n    }\n  }, [extraVideos])\n\n  return (\n    <div className=\"VideoPlayer\">\n      <vk-video-player ref={playerRef} />\n    </div>\n  )\n}\n"],"mappings":";;;AAAA,OAAOA,KAAP,IAAgBC,SAAhB,EAA2BC,MAA3B,QAAyC,OAAzC;AACA,SAASC,0BAAT,QAA2C,wBAA3C;AACA,OAAO,cAAP;AAEA;;;;AACA,MAAMC,cAAc,GAAG,MAAM;EAC3B,IAAI,CAACC,MAAM,CAACC,cAAP,CAAsBC,GAAtB,CAA0B,iBAA1B,CAAD,IAAiD,CAACF,MAAM,CAACC,cAAP,CAAsBC,GAAtB,CAA0B,oBAA1B,CAAtD,EAAuG;IACrGJ,0BAA0B;EAC3B;AACF,CAJD;;AAMAC,cAAc;AAEd,OAAO,SAASI,MAAT,CAAiBC,KAAjB,EAAwB;EAAA;;EAC7B,MAAM;IAAEC,GAAF;IAAOC;EAAP,IAAuBF,KAA7B;EAEA,MAAMG,SAAS,GAAGV,MAAM,CAAC,IAAD,CAAxB;EACA,MAAMW,YAAY,GAAGX,MAAM,CAAC,KAAD,CAA3B;EAEAD,SAAS,CAAC,MAAM;IACd,MAAMa,MAAM,GAAGF,SAAS,CAACG,OAAzB;;IACA,IAAID,MAAM,IAAIJ,GAAV,IAAiB,CAACG,YAAY,CAACE,OAAnC,EAA4C;MAC1CF,YAAY,CAACE,OAAb,GAAuB,IAAvB;MACAC,OAAO,CAACC,GAAR,CAAYH,MAAZ;MACAE,OAAO,CAACC,GAAR,CAAY,aAAZ,EAA2BP,GAA3B;;MACA,IAAI;QACFI,MAAM,CAACI,UAAP,CAAkB;UAChBC,MAAM,EAAE,CACN;YACEC,OAAO,EAAE;cACPC,IAAI,EAAE;gBACJ,SAASX;cADL;YADC,CADX;YAMEY,QAAQ,EAAE,IANZ;YAOEC,QAAQ,EAAE,EAPZ;YAQEC,KAAK,EAAE,OART;YASEC,aAAa,EAAE;UATjB,CADM,CADQ;UAehBC,QAAQ,EAAE,IAfM;UAgBhBC,MAAM,EAAE,IAhBQ;UAiBhBC,QAAQ,EAAE,IAjBM;UAkBhBC,SAAS,EAAE;YACTC,OAAO,GAAI;cACTd,OAAO,CAACC,GAAR,CAAY,OAAZ;YACD,CAHQ;;YAITc,SAAS,GAAI;cACXf,OAAO,CAACC,GAAR,CAAY,SAAZ;YACD;;UANQ;QAlBK,CAAlB;MA2BD,CA5BD,CA4BE,OAAOe,KAAP,EAAc;QACdhB,OAAO,CAACgB,KAAR,CAAc,yBAAd,EAAyCA,KAAzC;MACD;IACF;EACF,CAtCQ,EAsCN,CAACpB,SAAD,EAAYF,GAAZ,EAAiBG,YAAjB,CAtCM,CAAT;EAwCAZ,SAAS,CAAC,MAAM;IACd,MAAMa,MAAM,GAAGF,SAAS,CAACG,OAAzB;;IACA,IAAID,MAAM,IAAIH,WAAJ,aAAIA,WAAJ,eAAIA,WAAW,CAAEsB,MAA3B,EAAmC;MACjCnB,MAAM,CAACoB,gBAAP,CAAwBvB,WAAxB;IACD;EACF,CALQ,EAKN,CAACA,WAAD,CALM,CAAT;EAOA,oBACE;IAAK,SAAS,EAAC,aAAf;IAAA,uBACE;MAAiB,GAAG,EAAEC;IAAtB;MAAA;MAAA;MAAA;IAAA;EADF;IAAA;IAAA;IAAA;EAAA,QADF;AAKD;;GA1DeJ,M;;KAAAA,M"},"metadata":{},"sourceType":"module"}