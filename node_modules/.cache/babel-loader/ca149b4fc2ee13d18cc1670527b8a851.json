{"ast":null,"code":"import { canUseDOM } from './dom';\nexport var IPHONE_SAFARI_BOTTOM_BAR = 45;\nexport var IPHONE_X_SAFARI_BOTTOM_BAR = 85;\nexport var IPHONE_KEYBOARD_REJECT_OFFSET = 180; // 44 iPhone, 55 iPad, iPad Pro 69\n\nexport var IOS_NO_KEYBOARD_ALLOWED_OFFSET = 70;\nexport function detectIOS(ua) {\n  if (!ua) {\n    ua = canUseDOM ? navigator.userAgent.toLowerCase() : '';\n  }\n\n  var isIPadOS = checkIPadOS(ua);\n  var isIPad = isIPadOS || ua.indexOf('ipad') !== -1;\n  var isIPhone = !isIPad && ua.search(/iphone|ipod/) !== -1;\n  var isIOS = isIPhone || isIPad;\n  var iosVersion = isIOS && ua.match(/OS ([\\d_]+) like Mac OS X/i);\n  var iosMajor = 0;\n  var iosMinor = 0;\n\n  if (isIPadOS) {\n    iosMajor = 13;\n    iosMinor = 0;\n  } else if (iosVersion) {\n    iosVersion = iosVersion[1].split('_');\n    iosMajor = +iosVersion[0];\n    iosMinor = +iosVersion[1];\n  }\n\n  iosVersion = null;\n  var isScrollBasedViewport = iosMajor < 13 && !(iosMajor === 11 && iosMinor < 3);\n  var isWKWebView = isIOS && checkWKWebView(ua);\n  var isIPhoneX = false;\n\n  if (canUseDOM) {\n    isIPhoneX = isIOS && screen.width === 375 && screen.height === 812 && window.devicePixelRatio === 3;\n  }\n\n  var isIOSChrome = ua.search(/crios/i) !== -1;\n  return {\n    isIPad: isIPad,\n    isIPhone: isIPhone,\n    isIOS: isIOS,\n    isIPadOS: isIPadOS,\n    iosMajor: iosMajor,\n    iosMinor: iosMinor,\n    isWKWebView: isWKWebView,\n    isScrollBasedViewport: isScrollBasedViewport,\n    isIPhoneX: isIPhoneX,\n    isIOSChrome: isIOSChrome\n  };\n}\n\nvar _detectIOS = detectIOS(),\n    isIPad = _detectIOS.isIPad,\n    isIPhone = _detectIOS.isIPhone,\n    isIOS = _detectIOS.isIOS,\n    isIPadOS = _detectIOS.isIPadOS,\n    iosMajor = _detectIOS.iosMajor,\n    iosMinor = _detectIOS.iosMinor,\n    isWKWebView = _detectIOS.isWKWebView,\n    isScrollBasedViewport = _detectIOS.isScrollBasedViewport,\n    isIPhoneX = _detectIOS.isIPhoneX,\n    isIOSChrome = _detectIOS.isIOSChrome;\n\nexport { isIPad, isIPhone, isIOS, isIPadOS, iosMajor, iosMinor, isWKWebView, isScrollBasedViewport, isIPhoneX, isIOSChrome };\nexport function isLandscapePhone() {\n  return Math.abs(window.orientation) === 90 && !isIPad;\n} // Reference:\n// https://stackoverflow.com/questions/28795476/detect-if-page-is-loaded-inside-wkwebview-in-javascript/30495399#30495399\n\nfunction checkWKWebView(ua) {\n  if (!canUseDOM) {\n    return false;\n  }\n\n  var webkit = window.webkit;\n\n  if (webkit && webkit.messageHandlers) {\n    return true;\n  }\n\n  var lte9 = /constructor/i.test(String(window.HTMLElement));\n  var idb = !!window.indexedDB;\n\n  if (ua.indexOf('safari') !== -1 && ua.indexOf('version') !== -1 && !navigator.standalone) {// Safari (WKWebView/Nitro since 6+)\n  } else if (!idb && lte9 || !(window.statusbar && window.statusbar.visible)) {// UIWebView\n  } else if (!lte9 || idb) {\n    // WKWebView\n    return true;\n  }\n\n  return false;\n}\n\nexport function checkIPadOS(ua) {\n  if (!canUseDOM) {\n    return false;\n  }\n\n  var notIOS = !/ipad|iphone|ipod/.test(ua);\n  var macOS = /mac os/.test(ua);\n\n  if (macOS && notIOS && typeof navigator.standalone === 'boolean') {\n    return true;\n  }\n\n  return false;\n}","map":{"version":3,"mappings":"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","names":["canUseDOM","IPHONE_SAFARI_BOTTOM_BAR","IPHONE_X_SAFARI_BOTTOM_BAR","IPHONE_KEYBOARD_REJECT_OFFSET","IOS_NO_KEYBOARD_ALLOWED_OFFSET","detectIOS","ua","navigator","userAgent","toLowerCase","isIPadOS","checkIPadOS","isIPad","indexOf","isIPhone","search","isIOS","iosVersion","match","iosMajor","iosMinor","split","isScrollBasedViewport","isWKWebView","checkWKWebView","isIPhoneX","screen","width","height","window","devicePixelRatio","isIOSChrome","isLandscapePhone","Math","abs","orientation","webkit","messageHandlers","lte9","test","String","HTMLElement","idb","indexedDB","standalone","statusbar","visible","notIOS","macOS"],"sources":["/Users/al.balandin/code/vkvideo-test/node_modules/@vkontakte/vkui/node_modules/@vkontakte/vkjs/src/IOSDetections.ts"],"sourcesContent":["import { canUseDOM } from './dom';\n\nexport const IPHONE_SAFARI_BOTTOM_BAR = 45;\nexport const IPHONE_X_SAFARI_BOTTOM_BAR = 85;\n\nexport const IPHONE_KEYBOARD_REJECT_OFFSET = 180;\n\n// 44 iPhone, 55 iPad, iPad Pro 69\nexport const IOS_NO_KEYBOARD_ALLOWED_OFFSET = 70;\n\nexport function detectIOS(ua?: string) {\n  if (!ua) {\n    ua = canUseDOM ? navigator.userAgent.toLowerCase() : '';\n  }\n\n  const isIPadOS = checkIPadOS(ua);\n  const isIPad = isIPadOS || ua.indexOf('ipad') !== -1;\n  const isIPhone = !isIPad && ua.search(/iphone|ipod/) !== -1;\n  const isIOS = isIPhone || isIPad;\n\n  let iosVersion = isIOS && ua.match(/OS ([\\d_]+) like Mac OS X/i);\n  let iosMajor = 0;\n  let iosMinor = 0;\n\n  if (isIPadOS) {\n    iosMajor = 13;\n    iosMinor = 0;\n  } else if (iosVersion) {\n    iosVersion = iosVersion[1].split('_');\n    iosMajor = +iosVersion[0];\n    iosMinor = +iosVersion[1];\n  }\n\n  iosVersion = null;\n\n  const isScrollBasedViewport = iosMajor < 13 && !(iosMajor === 11 && iosMinor < 3);\n  const isWKWebView = isIOS && checkWKWebView(ua);\n\n  let isIPhoneX = false;\n\n  if (canUseDOM) {\n    isIPhoneX = isIOS && screen.width === 375 &&\n      screen.height === 812 && window.devicePixelRatio === 3;\n  }\n\n  const isIOSChrome = ua.search(/crios/i) !== -1;\n\n  return {\n    isIPad, isIPhone, isIOS, isIPadOS,\n    iosMajor, iosMinor,\n    isWKWebView, isScrollBasedViewport,\n    isIPhoneX,\n    isIOSChrome,\n  };\n}\n\nconst {\n  isIPad, isIPhone, isIOS, isIPadOS,\n  iosMajor, iosMinor,\n  isWKWebView, isScrollBasedViewport,\n  isIPhoneX,\n  isIOSChrome,\n} = detectIOS();\n\nexport {\n  isIPad, isIPhone, isIOS, isIPadOS,\n  iosMajor, iosMinor,\n  isWKWebView, isScrollBasedViewport,\n  isIPhoneX,\n  isIOSChrome,\n};\n\nexport function isLandscapePhone() {\n  return Math.abs(window.orientation as number) === 90 && !isIPad;\n}\n\n// Reference:\n// https://stackoverflow.com/questions/28795476/detect-if-page-is-loaded-inside-wkwebview-in-javascript/30495399#30495399\nfunction checkWKWebView(ua: string) {\n  if (!canUseDOM) {\n    return false;\n  }\n\n  const webkit = (window as any).webkit;\n\n  if (webkit && webkit.messageHandlers) {\n    return true;\n  }\n\n  const lte9 = /constructor/i.test(String(window.HTMLElement));\n  const idb = !!window.indexedDB;\n\n  if (\n    ua.indexOf('safari') !== -1 &&\n    ua.indexOf('version') !== -1 &&\n    !(navigator as any).standalone\n  ) {\n    // Safari (WKWebView/Nitro since 6+)\n  } else if ((!idb && lte9) || !(window.statusbar && window.statusbar.visible)) {\n    // UIWebView\n  } else if (!lte9 || idb) {\n    // WKWebView\n    return true;\n  }\n\n  return false;\n}\n\nexport function checkIPadOS(ua: string) {\n  if (!canUseDOM) {\n    return false;\n  }\n\n  const notIOS = !/ipad|iphone|ipod/.test(ua);\n  const macOS = /mac os/.test(ua);\n\n  if (macOS && notIOS && typeof (navigator as any).standalone === 'boolean') {\n    return true;\n  }\n\n  return false;\n}\n"]},"metadata":{},"sourceType":"module"}